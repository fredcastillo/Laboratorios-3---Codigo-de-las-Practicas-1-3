# ================================
# üß© M√ìDULO 3 ‚Äî Discos, Particiones y Montajes (CentOS Stream 10)
# ================================


# ============================================================
# PRACTICA 1 ‚Äî Ver Discos, Crear Partici√≥n y Formatear EXT4
# ============================================================

# #1 ‚Äî Ver discos conectados
sudo su
lsblk

# #2 ‚Äî Crear partici√≥n en /dev/sdb
fdisk /dev/sdb
m
n
w

# #3 ‚Äî Formatear partici√≥n en EXT4
mkfs.ext4 /dev/sdb1

# #4 ‚Äî Crear carpeta y montar
mkdir /home/usuario/Desktop/Fred1
mount /dev/sdb1 /home/usuario/Desktop/Fred1
cd /home/usuario/Desktop/Fred1
touch "Adri√°n Alc√°ntara.txt"

# #5 ‚Äî Desmontar y montar en /mnt
umount /dev/sdb1
mount /dev/sdb1 /mnt
cd /mnt


# -------------------------
# ‚ùó NOTAS, ERRORES Y SOLUCIONES (Pr√°ctica 1)
# -------------------------

‚ùó Nota 1 ‚Äî El disco no aparece en lsblk  
- Soluci√≥n: Reiniciar la VM o reconectar el disco virtual.

‚ùó Nota 2 ‚Äî fdisk no deja modificar el disco  
- Soluci√≥n:
  umount /dev/sdb1

‚ùó Nota 3 ‚Äî mkfs.ext4 falla  
- Causa: La partici√≥n est√° da√±ada
- Soluci√≥n:
  wipefs -a /dev/sdb

‚ùó Nota 4 ‚Äî La carpeta no existe realmente  
- Asegurarse que usas la ruta completa correcta del usuario:
  /home/usuario/Desktop/Fred1

‚ùó Nota 5 ‚Äî El archivo no aparece en /mnt  
- Verificar con:
  ls /mnt


# -------------------------
# üìò T√âRMINOS IMPORTANTES (Pr√°ctica 1)
# -------------------------

lsblk: Comando para ver discos conectados y particiones.  
fdisk: Herramienta para crear y administrar particiones.  
ext4: Sistema de archivos moderno y estable usado en Linux.  
mkfs.ext4: Formatea una partici√≥n en formato EXT4.  
mount: Conecta una partici√≥n a una carpeta.  
umount: Desmonta una partici√≥n.  
/mnt: Carpeta est√°ndar para montajes temporales.


# ============================================================
# PRACTICA 2 ‚Äî Crear, Eliminar y Reparar Particiones
# ============================================================
Crea el disco desde las configuraciones de la maquina en VMWARE
# #1 ‚Äî Ver discos
sudo su
lsblk

# #2 ‚Äî Entrar a fdisk en /dev/sdb
fdisk /dev/sdb
d
n
w

# #3 ‚Äî Formatear de nuevo
mkfs.ext4 /dev/sdb1

# #4 ‚Äî Montar en /mnt/disco2
mkdir /mnt/disco2
mount /dev/sdb1 /mnt/disco2
cd /mnt/disco2

# #5 ‚Äî Crear archivo de prueba
touch "Archivo_de_prueba.txt"


# -------------------------
# ‚ùó NOTAS, ERRORES Y SOLUCIONES (Pr√°ctica 2)
# -------------------------

‚ùó Nota 1 ‚Äî d no borra la partici√≥n  
- Varios discos pueden estar montados  
- Soluci√≥n:
  umount /dev/sdb1

‚ùó Nota 2 ‚Äî Nuevo n√∫mero de partici√≥n  
- fdisk puede preguntar n√∫mero  
- Solo presiona Enter

‚ùó Nota 3 ‚Äî "device is busy"  
- Soluci√≥n:
  fuser -v /dev/sdb1
  umount /dev/sdb1

‚ùó Nota 4 ‚Äî No puedes montar en /mnt/disco2  
- Crear la carpeta:
  mkdir /mnt/disco2


# -------------------------
# üìò T√âRMINOS IMPORTANTES (Pr√°ctica 2)
# -------------------------

d (delete): Borra una partici√≥n dentro de fdisk.  
n (new): Crea una partici√≥n.  
w (write): Guarda los cambios.  
fuser: Muestra qu√© procesos est√°n usando un disco.  
Montaje persistente: Montaje que se mantiene al reiniciar (usando /etc/fstab).


# ============================================================
# PRACTICA 3 ‚Äî Verificar Persistencia y Configurar Aut√≥matas de Montaje
# ============================================================

# #1 ‚Äî Verificar estado del disco
sudo su
lsblk
mount | grep sdb1

# #2 ‚Äî Editar fstab para montar autom√°ticamente
nano /etc/fstab

# (dentro del archivo se agrega)
# /dev/sdb1   /mnt/disco2   ext4   defaults   0 0

# #3 ‚Äî Probar que fstab funciona
umount /dev/sdb1
mount -a
ls /mnt/disco2

# #4 ‚Äî Reiniciar y verificar persistencia
reboot

# #5 ‚Äî Verificar montaje al iniciar
lsblk
ls /mnt/disco2


# -------------------------
# ‚ùó NOTAS, ERRORES Y SOLUCIONES (Pr√°ctica 3)
# -------------------------

‚ùó Nota 1 ‚Äî "mount: wrong fs type"  
- Causa: fstab mal escrito  
- Soluci√≥n:
  Revisar que el campo exacto sea:
  /dev/sdb1   /mnt/disco2   ext4   defaults   0 0

‚ùó Nota 2 ‚Äî El sistema no arranca por error en fstab  
- Soluci√≥n desde la consola de emergencia:
  mount -o remount,rw /
  nano /etc/fstab
  corregir el error

‚ùó Nota 3 ‚Äî No monta al reiniciar  
- Soluci√≥n:
  systemctl daemon-reload
  mount -a

‚ùó Nota 4 ‚Äî "target is busy"  
- Soluci√≥n:
  fuser -mv /mnt/disco2
  umount /mnt/disco2


# -------------------------
# üìò T√âRMINOS IMPORTANTES (Pr√°ctica 3)
# -------------------------

fstab: Archivo donde se definen montajes autom√°ticos.  
mount -a: Monta todos los dispositivos definidos en fstab.  
defaults: Par√°metros est√°ndar para montajes ext4.  
Persistencia: Que el montaje sobreviva a un reinicio.  
Consola de emergencia: Modo de reparaci√≥n cuando fstab falla.




------- - version 1 - ------------
‚ùó Nota: Version original utilizada para la elaboracion de los videos y practicas, pero menos descriptiva
dejada aqui para referencia.

Comandos usados practica 1

(En la terminal)

sudo su
nano /etc/default/grub
(Se cambio el TIMEOUT a 20)

ctrl + o 
enter
ctrl + x

grub2-mkconfig -o /boot/grub2/grub.cfg
reboot now

(En el menu grub)

e
ctrl + e (En la linea que empieza con la palabra "Linux")
rw init=/bin/bash
ctrl + x 

mount -o remount,rw /sysroot
chroot /sysroot
passwd
touch ./autorelabel
exec /sbin/reboot -f

(Probando si el cambio fue exitoso)

su
whoami

============================================

Comandos usados practica 2

nano Adrian.sh

#!/bin/bash
tar -czvf /home/fred/backup_$(date +-%d-%m-%Y:%H:%M)tar.gz /home/fred

ctrl + o (guardar)
enter 
ctrl + x (Salir)

sudo chmod +x Adrian.sh

./Adrian.sh

nano Alcantara.sh

#!/bin/bash
read -p "Ingrese el nombre del documento: " N; ifconfig > "$HOME/Escritorio/$N" 
echo "EL archivo $N se ha guardado correctamente."

ctrl + o (guardar)
enter 
ctrl + x (Salir)

sudo chmod +x Alcantara.sh

./Alcantara.sh

cat N

============================================

Comandos usados practica 3

(CentOS terminal)

ifconfig

(Windows terminal)

ping 192.168.100.168

(CentOS terminal)

sudo su
dnf install openssh-server
systemctl start sshd
systemctl enable sshd
systemctl status sshd

(Windows terminal)

ssh fred@192.168.100.168
(Aqu√≠ pide contrase√±a)

ls (demostrando el uso de ssh)
rm authorized keys 
touch 20252175.txt
exit

ssh-keygen
notepad users\mkm26/ .ssh/id_ed25519.pub
(Copiar la llave publica)


(CentOS terminal)

exit(salir del modo root)
mkdir .ssh
cd .ssh
sudo nano authorized_keys
(pegamos la llave publica)
ctrl + o (guardar)
enter 
ctrl + x (Salir)

(Windows terminal)
ssh fred@192.168.100.168
(Ya no nos pide contrase√±a)








============================================

